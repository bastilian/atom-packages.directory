<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Atom Packages Directory</title>
    <link rel="stylesheet" href="/assets/application.css">
    <link rel="stylesheet" href="/assets/admin.css">

  </head>
  <body>
    <header>
      <h1><a href="/"><span class="octicon octicon-package"></span>Atom Packages Directory</a></h1>
      <span class="subheader">a package directory for a <a href="http://atom.io">text editor of the 21st Century</a></span>
    </header>
    <section id="content">
      <h1>Particle Offline Compiler</h1>
<h1 id="particle-offline-compiler">particle-offline-compiler</h1>

<p>An Atom / Particle Dev package for 100% offline code compilation for Particle Devices.</p>

<p>For situations where you <em>need</em> to compile and test Particle projects locally, and keep to a streamlined workflow.</p>

<p>This should be compatible with projects that connect to Particle.io, or if you’re deploying your own local cloud.</p>

<h2 id="requirements">Requirements</h2>

<ol>
  <li>
    <p><strong>particle local compiler</strong><br />
Install the Particle local compiler (<a href="https://github.com/spark/firmware/tree/latest">full instructions here</a>), including dependencies.</p>

    <p>This package also assumes that you have the latest <code>particle-cli</code> installed on your system – this will be required for OTA updates (coming soon)</p>
  </li>
  <li>
    <p><strong>particle-cli</strong><br />
To install particle-cli:<br />
<code>
$ npm install -g particle-cli
$ particle cloud login
</code></p>
  </li>
</ol>

<h2 id="installation">Installation</h2>
<p>In <code>atom / Particle Dev &gt; Preferences &gt; Install</code>, search for <code>particle-offline-compiler</code> and install it.</p>

<p>Before using it, open up the settings on the package, and enter the Particle Compiler Path – this should point to the location where you downloaded and compiled the <strong>particle local compiler</strong> (see instructions above). The <strong>Device Type</strong> and <strong>Serial Port</strong> can be left empty, as they can be set easily in the <strong>Particle.offline</strong> user menu.</p>

<p>Once installed, you should see a <strong>Particle.offline</strong> menubar with self-explanatory options listed.</p>

<h2 id="usage-instructions">Usage Instructions</h2>
<ul>
  <li>If you’re using the package in atom, ensure the following:
    <ul>
      <li>use <code>.cpp</code> file extensions, not <code>.ino</code></li>
      <li>declare <code>#include "application.h"</code> at the top of your main <code>.cpp</code> file</li>
      <li><code>*.cpp/*.h</code> libraries should be in the same folder as your main <code>.cpp</code> file</li>
      <li>declare your C prototypes manually, either in a <code>.h</code> file of the same name as the main <code>.cpp</code> file, or alternatively at the beginning of your main <code>.cpp</code> file.</li>
    </ul>
  </li>
  <li>The <code>[refresh DFU serial device list]</code> menu item under <code>Particle.offline &gt; DFU serial port</code> needs to be manually refreshed to get the latest list of serial devices connected to your computer.</li>
  <li>If you are connecting multiple Particle devices to your computer at any one time, be sure to double-check the serial port that you are uploading to!</li>
  <li>Choose <code>Compile locally + DFU upload</code> to compile and upload your code. You might want to toggle the Console first to see the progress of the compilation and spot errors.</li>
</ul>

<h2 id="osx--important-note-on-environment-variables">OSX – Important note on environment variables:</h2>

<p>In order for all of your PATH environment variables to be picked up, <strong>launch Atom from the terminal</strong>:</p>

<pre><code>$ open -a "/Applications/Atom.app"
</code></pre>

<p>or, if you have already installed the Atom Shell commands:</p>

<pre><code>$ atom
</code></pre>

<p>If you’re using Particle Dev, launch the application similarly from Terminal:</p>

<pre><code>open -a "/Applications/Particle Dev.app"
</code></pre>

<p>If you skip this step, the compile will <em>not</em> be able to find <code>arm-none-eabi-gcc</code> in your PATH environment variable, as the standard PATH launched from a Finder instance of Atom most likely excludes the gcc compiler location (default: /usr/local/bin).</p>

<h2 id="work-in-progress">Work in progress!</h2>

<p>This is a work in progress.</p>

<p>At this point the package is only tested on OSX Yosemite, Atom 1.0.3+ and Particle Dev 0.0.25. YMMV.</p>

<p>Compiler output is currently dumped out the Javascript console – sorry to those who prefer spiffier GUIs, but the console is good enough for now to figure out what’s going on during the compile process. Perhaps a proper view with syntax coloring can be considered in the future.</p>

<p><code>Dfu-util</code> has a bug where the conclusion of every firmware upload presents <code>STDERR: dfu-util: Error during download get_status</code>, despite the firmware uploading OK. This can be safely ignored.</p>

<p>Key features:
* Automatic DFU (Core/Photon) upload of firmware works – no need to put your device manually into DFU mode
* <em>(to implement)</em> Core OTA updates
* <em>(to implement)</em> Photon OTA updates, currently not supported in the 0.4.3rc2 firmware of the Photon devices for local clouds, so we’ll have to wait until Particle releases a major update to <code>particle-server</code></p>

<h2 id="wait-isnt-there-particle-dev-that-does-the-same-thing">Wait, isn’t there Particle Dev that does the same thing?</h2>

<p>Yes and no. <a href="https://www.particle.io/dev">Particle Dev</a>, which was built on top of Atom Shell a.k.a. Electron, is a fantastic project that addresses a specific need – quick, easy local <strong>development</strong> (and storage) of code, with firmware builds/uploads still routed through Particle.io for ease of use. This same ease of use presents workflow obstacles when it comes to local cloud development, and slows down development massively.</p>

<p>This package was developed to improve workflow bottlenecks of the existing official Particle IDEs (Build Web IDE and Particle Dev).</p>

<p>If you encounter any of these scenarios, I hope this package will be of help:</p>

<ul>
  <li>
    <p>You are developing a local cloud. Your current means of uploading new firmware is a combination of a) writing code in the Build Web IDE / Particle Dev, b) downloading the .bin files manually, before c) using <code>particle-cli</code> to send OTA updates to your Core(s), or perhaps, via DFU to your Photons. It’s a slow process switching through these tasks just to get firmware uploaded.</p>
  </li>
  <li>
    <p>You want to try out the latest firmware releases from Particle.io and/or custom code libraries, but the Build Web IDE is still pegged to earlier, stable builds (for good reason), leaving you to build your own local compiler, but without a streamlined way to upload your binaries to your devices.</p>
  </li>
</ul>

<p>It’s worth noting that Particle Dev (and the Particle platform at large) goes through continuous development, and will <em>eventually</em> implement much better development workflows. This tiny Atom package might be helpful for those who want an immediate, interim solution to a faster workflow for local-cloud and/or offline Particle projects.</p>

particle,cloud,local,offline,build
    </section>
    <footer>
      <p>
        Made with <span class="octicon octicon-heart"></span> by <a href="http://bastilian.me">@bastilian</a>
      </p>
      <p>
        <small>Last updated: 2016-04-29</small>
      </p>
    </footer>
    <div style="opacity:.15;position:relative;z-index:-1;">
      <div class="system"></div>
      <div class="system-2"></div>
    </div>
    <a href="https://github.com/bastilian/atom-packages.directory">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
    </a>
  </body>
</html>
